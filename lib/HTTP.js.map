{"version":3,"file":"HTTP.js","sourceRoot":"","sources":["../src/HTTP.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+CAAiC;AAEjC,sDAAmD;AAEnD,MAAa,IAAI;IAGf,YAAsB,MAAc;QAAd,WAAM,GAAN,MAAM,CAAQ;IAAG,CAAC;IAEjC,GAAG,CACR,IAAY,EACZ,UAAmC,EAAE;QAErC,OAAO,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;IAC5C,CAAC;IAEM,IAAI,CACT,IAAY,EACZ,UAAmC,EAAE;QAErC,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;IAC7C,CAAC;IAEM,GAAG,CACR,IAAY,EACZ,UAAmC,EAAE;QAErC,OAAO,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;IAC5C,CAAC;IAEM,GAAG,CACR,IAAY,EACZ,UAAmC,EAAE;QAErC,OAAO,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;IAC5C,CAAC;IAES,OAAO,CACf,MAAsC,EACtC,IAAY,EACZ,UAAmC,EAAE;QAErC,OAAO,MAAM,CAAC,MAAM,CAAC,CACnB,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAAC,EACpC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CACzB,CAAC,KAAK,CAAC,CAAC,CAAM,EAAE,EAAE;;YACjB,MAAM,IAAI,yBAAW,CACnB,CAAC,CAAC,UAAU,IAAI,CAAC,CAAC,EAClB,CAAA,MAAA,CAAC,CAAC,IAAI,0CAAE,KAAK,KAAI,CAAC,CAAC,aAAa,IAAI,CAAC,CAAC,OAAO,IAAI,SAAS,CAC3D,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC;IAES,UAAU,CAAC,OAAgC;QACnD,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE;gBACpB,OAAO,CAAC,OAAO,GAAG,EAAE,CAAC;aACtB;YAED,OAAO,CAAC,OAAO,CAAC,eAAe,CAAC,GAAG,UAAU,IAAI,CAAC,SAAS,EAAE,CAAC;YAC9D,OAAO,CAAC,eAAe,GAAG,IAAI,CAAC;SAChC;QAED,OAAO,OAAO,CAAC;IACjB,CAAC;CACF;AA7DD,oBA6DC","sourcesContent":["import * as httpie from \"httpie\";\nimport { Client } from \"./Client\";\nimport { ServerError } from \"./errors/ServerError\";\n\nexport class HTTP {\n  public authToken: string;\n\n  constructor(protected client: Client) {}\n\n  public get<T = any>(\n    path: string,\n    options: Partial<httpie.Options> = {}\n  ): Promise<httpie.Response<T>> {\n    return this.request(\"get\", path, options);\n  }\n\n  public post<T = any>(\n    path: string,\n    options: Partial<httpie.Options> = {}\n  ): Promise<httpie.Response<T>> {\n    return this.request(\"post\", path, options);\n  }\n\n  public del<T = any>(\n    path: string,\n    options: Partial<httpie.Options> = {}\n  ): Promise<httpie.Response<T>> {\n    return this.request(\"del\", path, options);\n  }\n\n  public put<T = any>(\n    path: string,\n    options: Partial<httpie.Options> = {}\n  ): Promise<httpie.Response<T>> {\n    return this.request(\"put\", path, options);\n  }\n\n  protected request(\n    method: \"get\" | \"post\" | \"put\" | \"del\",\n    path: string,\n    options: Partial<httpie.Options> = {}\n  ): Promise<httpie.Response> {\n    return httpie[method](\n      this.client[\"getHttpEndpoint\"](path),\n      this.getOptions(options)\n    ).catch((e: any) => {\n      throw new ServerError(\n        e.statusCode || -1,\n        e.data?.error || e.statusMessage || e.message || \"offline\"\n      );\n    });\n  }\n\n  protected getOptions(options: Partial<httpie.Options>) {\n    if (this.authToken) {\n      if (!options.headers) {\n        options.headers = {};\n      }\n\n      options.headers[\"Authorization\"] = `Bearer ${this.authToken}`;\n      options.withCredentials = true;\n    }\n\n    return options;\n  }\n}\n"]}